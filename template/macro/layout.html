{% import 'macro/stories.html' as story_blocks %}

{% macro heading(heading_text, link, colour='#ffffff', bg_colour='#000000') -%}
<table width="100%" cellpadding="0" cellspacing="0" border="0" bgcolor="{{ bg_colour }}">
	<tr valign="top">
        {% if link %}
            <td align="left" style="padding: 0 0 0 20px;">
                <a class="section-heading" href="{{ link }}" style="font: 14px Georgia, serif; display: block; padding: 10px 0; font-weight: normal; color: {{ colour }}; text-decoration: none;">
                    {{ heading_text }}
                </a>
            </td>
            <td width="80" align="center">
                <a href="{{ link }}" style="font: 12px Arial, sans-serif; display: block; font-weight: normal; color: {{ colour }}; text-decoration: none;">
                    <span style="display: block; padding: 10px 0; border-left: 1px solid #ffffff;">More <span style="font-size: 15px;">&#187;</span></span>
                </a>
            </td>
        {% else %}
        <td align="left" style="padding: 0 0 0 20px;font: Georgia, serif; display: block; padding: 10px 0; font-size: 17px, !important; margin-left: 20px; color: {{ colour }}; text-decoration: none;">
                {{ heading_text }}
        </td>
        {% endif %}
	</tr>
</table>
{%- endmacro %}


{% macro picture_of_day(picture_of_day) -%}
{% set picture = [picture_of_day[0].mediaAssets[0]] %}
{% for media_asset in picture_of_day[0].mediaAssets if '460' == media_asset.fields.width %}
	{% if picture.append(media_asset) %}{% endif %}
{% endfor %}

{% if picture[1] %}
	{% set picture = picture[1] %}
{% else %}
	{% set picture = picture[0] %}
{% endif %}

<tr><td>
	<table width="100%" cellpadding="0" cellspacing="0" border="0" bgcolor="#424242" style="padding-bottom: 20px;">
		<tr><td>{{ heading(heading_text='Eyewitness picture of the day', link='http://www.guardian.co.uk/world/series/eyewitness', bg_colour='#00acda') }}</td></tr>
		<tr><td align="left"><a href="{{ picture_of_day[0].webUrl }}"><img src="{{ picture.file }}" width="100%" alt="{{ picture.fields.altText }}" border="0" /></a></td></tr>
		<tr>
			<td align="left" style="color: #ffffff; font-weight: bold; font: 12px Helvetica, Arial, sans-serif; padding: 12px 25px 0 25px;">{{ picture.fields.caption }}</td>
		</tr>
		<tr>
			<td align="left" style="color: #ccc; font: 12px Helvetica, Arial, sans-serif; padding: 0 25px 0 25px;">{{ picture.fields.source }}</td>
		</tr>
	</table>
</td></tr>
{% endmacro %}


{% macro story_trail(heading_text, stories, heading_link=None, heading_colour='#000000', more_text=None, thumbnail=False, top_thumb=False, standfirst=True, show_more=True, first_para=False) -%}
{% if not more_text %}
	{% set more_text = heading_text|lower %}
{% endif %}
<tr><td>{{ heading(heading_text=heading_text, link=heading_link, bg_colour=heading_colour) }}<td></tr>
<tr><td align="left">
	{% for story in stories %}
		{% if loop.index == 1 and top_thumb %}
			{% set use_thumbnail = True %}
			{% set use_standfirst = True %}
		{% else %}
			{% set use_thumbnail = False %}
			{% set use_standfirst = standfirst %}
		{% endif %}
		{{ story_blocks.story(story, loop.index == 1, thumbnail=use_thumbnail, standfirst=use_standfirst, first_para=first_para) }}
	{% endfor %}
</td></tr>
{%- endmacro %}

{% macro advert(ad_html) -%}
<tr><td style="padding: 10px; background: #c6ddf1; display: block; border-top: 10px solid #faf9f8; border-bottom: 10px solid #faf9f8;" align="center">
<table cellpadding="0" cellspacing="0" border="0" style="width: 100%; max-width: 468px;">
	<tr valign="top">
		<td align="center" style="font: 16px Helvetica, Arial, sans-serif; font-weight: bold; padding: 0; text-align: center;">{{ ad_html }}</td>
	</tr>
</table>
</td></tr>
{%- endmacro %}
