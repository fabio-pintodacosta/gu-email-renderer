{% import 'macro/stories.html' as story_blocks %}

{% macro heading(heading_text, link, colour='#333', border_top=True, border_bottom=True, sidebar_colour='#000000') -%}
<table width="100%" cellpadding="0" cellspacing="0" border="0" style="border-left: 15px solid {{ sidebar_colour }};">
	<tr valign="top">
		<td align="left" style="{% if border_top %}border-top: 1px solid #dedede;{% endif %}{% if border_bottom %} border-bottom: 1px solid #dedede;{% endif %}">
			{% if link %}<a href="{{ link }}" style="font: 16px Georgia, Arial, sans-serif; display: block; font-weight: normal; padding: 8px 0 8px 10px; color: {{ colour }}; text-decoration: none;">{% endif %}
				{{ heading_text }}
			{% if link %}</a>{% endif %}
		</td>
	</tr>
</table>
{%- endmacro %}


{% macro picture_of_day(picture_of_day) -%}
{% set picture = [picture_of_day[0].mediaAssets[0]] %}
{% for media_asset in picture_of_day[0].mediaAssets if '460' == media_asset.fields.width %}
	{% if picture.append(media_asset) %}{% endif %}
{% endfor %}

{% if picture[1] %}
	{% set picture = picture[1] %}
{% else %}
	{% set picture = picture[0] %}
{% endif %}

<tr><td style="padding-top: 20px;">
	<table width="100%" cellpadding="0" cellspacing="0" border="0" bgcolor="#424242">
		<tr><td>{{ heading(heading_text='Eyewitness picture of the day', colour='#ffffff', border_top=False, border_bottom=False, link='http://www.guardian.co.uk/world/series/eyewitness', sidebar_colour='#00acda') }}</td></tr>
		<tr><td align="left"><a href="{{ picture_of_day[0].webUrl }}"><img src="{{ picture.file }}" width="100%" alt="{{ picture.fields.altText }}" border="0" /></a></td></tr>
		<tr>
			<td align="left" style="color: #ffffff; font-weight: bold; font: 12px Helvetica, Arial, sans-serif; padding: 12px 25px 0 25px;">{{ picture.fields.caption }}</td>
		</tr>
		<tr>
			<td align="left" style="color: #ccc; font: 12px Helvetica, Arial, sans-serif; padding: 0 25px 0 25px;">{{ picture.fields.source }}</td>
		</tr>
		<tr>
			<td align="left" style="font: 13px Helvetica, Arial, sans-serif; padding: 10px 25px; font-weight: bold">
				<a href="http://www.guardian.co.uk/inpictures" style="color: #00acda; text-decoration: none;">More galleries <span style="font-size: 15px; vertical-align: top; display:inline-block;">&#187;</span></a>
			</td>
		</tr>
	</table>
</td></tr>
{% endmacro %}


{% macro story_trail(heading_text, stories, heading_link=None, sidebar_colour='#000000', more_text=None, thumbnail=True, standfirst=False, show_more=True, first_para=False) -%}
{% if not more_text %}
	{% set more_text = heading_text|lower %}
{% endif %}
<tr><td style="padding-top: 20px;">{{ heading(heading_text=heading_text, link=heading_link, sidebar_colour=sidebar_colour) }}<td></tr>
<tr><td align="left">		
	{% for story in stories %}
		{% if loop.index <= 3 and thumbnail %}
			{% set thumbnail = True %}
		{% else %}	
			{% set thumbnail = False %}
		{% endif %}

		{{ story_blocks.story(story, loop.index == 1, thumbnail=thumbnail, standfirst=standfirst, first_para=first_para) }}
	{% endfor %}
	
`	{% if show_more %}
	<table width="100%" cellpadding="0" cellspacing="0" border="0" style="padding: 0 25px;">
		<tr>
			<td align="right"><a style="margin-top: 12px; display: block; padding: 12px 0 0 0; border-top: 1px dotted #dedede; color: #006fd5; font: 13px Helvetica, Arial, sans-serif; text-decoration: none; font-weight: bold;" href="{{ heading_link }}">More {{ more_text }} <span style="font-size: 15px; vertical-align: top; display:inline-block;">&#187;</span></a></td>
		</tr>
	</table>
	{% endif %}

</td></tr>
{%- endmacro %}

{% macro advert(ad_html) -%}
<tr><td style="padding: 10px; background: #c6ddf1; display: block; border-top: 10px solid #faf9f8; border-bottom: 10px solid #faf9f8;" align="center">
<table cellpadding="0" cellspacing="0" border="0" style="width: 100%; max-width: 468px;">
	<tr valign="top">
		<td align="center" style="font: 16px Helvetica, Arial, sans-serif; font-weight: bold; padding: 0; text-align: center;">{{ ad_html }}</td>
	</tr>
</table>
</td></tr>
{%- endmacro %}
